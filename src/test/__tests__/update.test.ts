import { orm,Helper } from '../../lib'
beforeAll(async () => {
	require('dotenv').config({ path: './test.env' })
	await orm.init()
})
describe('Complete Expression', () => {
	test('update 1', () => {
		const source = 'Orders.update()'
		const expected = 'Orders.filter(p=>(p.id==id)).update({customerId:customerId,employeeId:employeeId,orderDate:orderDate,requiredDate:requiredDate,shippedDate:shippedDate,shipViaId:shipViaId,freight:freight,name:name,address:address,city:city,region:region,postalCode:postalCode,country:country})'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 2', () => {
		const source = 'Orders.update(entity)'
		const expected = 'Orders.filter(p=>(p.id==entity.id)).update({customerId:entity.customerId,employeeId:entity.employeeId,orderDate:entity.orderDate,requiredDate:entity.requiredDate,shippedDate:entity.shippedDate,shipViaId:entity.shipViaId,freight:entity.freight,name:entity.name,address:entity.address,city:entity.city,region:entity.region,postalCode:entity.postalCode,country:entity.country})'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 3', () => {
		const source = 'Orders.updateAll(=>{postalCode:postalCode})'
		const expected = 'Orders.update(=>{postalCode:postalCode})'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 4', () => {
		const source = 'Orders.update(p=>{name:entity.name}).filter(p=>(p.id===entity.id))'
		const expected = 'Orders.update(p=>{name:entity.name}).filter(p=>(p.id===entity.id))'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 5', () => {
		const source = 'Orders.update(=>{name:entity.name}).include(p=>p.details).filter(p=>(p.id===entity.id))'
		const expected = 'Orders.update(=>{name:entity.name}).include(p=>p.details.filter(p=>((p.orderId==orderId)&&(p.productId==productId))).update({orderId:orderId,productId:productId,unitPrice:unitPrice,quantity:quantity,discount:discount})).filter(p=>(p.id===entity.id))'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 6', () => {
		const source = 'Orders.update(=>{name:entity.name}).include(p=>p.details.update(p=>p)).filter(p=>(p.id===entity.id))'
		const expected = 'Orders.update(=>{name:entity.name}).include(p=>p.details.filter(p=>((p.orderId==orderId)&&(p.productId==productId))).update(p=>{unitPrice:p.unitPrice,quantity:p.quantity,discount:p.discount})).filter(p=>(p.id===entity.id))'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 7', () => {
		const source = 'Orders.update(=>{name:entity.name}).include(p=>p.details.update(p=>{unitPrice:p.unitPrice,productId:p.productId})).filter(p=>(p.id===entity.id))'
		const expected = 'Orders.update(=>{name:entity.name}).include(p=>p.details.filter(p=>((p.orderId==orderId)&&(p.productId==productId))).update(p=>{unitPrice:p.unitPrice,productId:p.productId})).filter(p=>(p.id===entity.id))'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 8', () => {
		const source = 'Orders.update().include(p=>p.details)'
		const expected = 'Orders.filter(p=>(p.id==id)).update({customerId:customerId,employeeId:employeeId,orderDate:orderDate,requiredDate:requiredDate,shippedDate:shippedDate,shipViaId:shipViaId,freight:freight,name:name,address:address,city:city,region:region,postalCode:postalCode,country:country}).include(p=>p.details.filter(p=>((p.orderId==orderId)&&(p.productId==productId))).update({orderId:orderId,productId:productId,unitPrice:unitPrice,quantity:quantity,discount:discount}))'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
	test('update 9', () => {
		const source = 'Customers.update().include(p=>p.orders.include(p=>p.details))'
		const expected = 'Customers.filter(p=>(p.id==id)).update({id:id,name:name,contact:contact,phone:phone,address:address,city:city,region:region,postalCode:postalCode,country:country}).include(p=>p.orders.include(p=>p.details.filter(p=>((p.orderId==orderId)&&(p.productId==productId))).update({orderId:orderId,productId:productId,unitPrice:unitPrice,quantity:quantity,discount:discount})).filter(p=>(p.id==id)).update({customerId:customerId,employeeId:employeeId,orderDate:orderDate,requiredDate:requiredDate,shippedDate:shippedDate,shipViaId:shipViaId,freight:freight,name:name,address:address,city:city,region:region,postalCode:postalCode,country:country}))'
		const target = orm.normalize(source)
		expect(expected).toBe(target)
	})
})
describe('Metadata', () => {
	test('update 1', async () => {
		const expression = 'Orders.update()'
		const modelExpected :any= [{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}]
		const parametersExpected:any = [{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"integer"}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"==","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"id","classtype":"Variable","children":[],"type":"integer","number":14}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"customerId","classtype":"KeyValue","children":[{"name":"customerId","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"customerId"},{"name":"employeeId","classtype":"KeyValue","children":[{"name":"employeeId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"employeeId"},{"name":"orderDate","classtype":"KeyValue","children":[{"name":"orderDate","classtype":"Variable","children":[],"type":"datetime","number":3}],"type":"any","property":"orderDate"},{"name":"requiredDate","classtype":"KeyValue","children":[{"name":"requiredDate","classtype":"Variable","children":[],"type":"date","number":4}],"type":"any","property":"requiredDate"},{"name":"shippedDate","classtype":"KeyValue","children":[{"name":"shippedDate","classtype":"Variable","children":[],"type":"date","number":5}],"type":"any","property":"shippedDate"},{"name":"shipViaId","classtype":"KeyValue","children":[{"name":"shipViaId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any","property":"shipViaId"},{"name":"freight","classtype":"KeyValue","children":[{"name":"freight","classtype":"Variable","children":[],"type":"decimal","number":7}],"type":"any","property":"freight"},{"name":"name","classtype":"KeyValue","children":[{"name":"name","classtype":"Variable","children":[],"type":"string","number":8}],"type":"any","property":"name"},{"name":"address","classtype":"KeyValue","children":[{"name":"address","classtype":"Variable","children":[],"type":"string","number":9}],"type":"any","property":"address"},{"name":"city","classtype":"KeyValue","children":[{"name":"city","classtype":"Variable","children":[],"type":"string","number":10}],"type":"any","property":"city"},{"name":"region","classtype":"KeyValue","children":[{"name":"region","classtype":"Variable","children":[],"type":"string","number":11}],"type":"any","property":"region"},{"name":"postalCode","classtype":"KeyValue","children":[{"name":"postalCode","classtype":"Variable","children":[],"type":"string","number":12}],"type":"any","property":"postalCode"},{"name":"country","classtype":"KeyValue","children":[{"name":"country","classtype":"Variable","children":[],"type":"string","number":13}],"type":"any","property":"country"}],"type":"object"}],"type":"any","alias":"o"}],"type":"any","columns":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}],"parameters":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"integer"}],"entity":"Orders","constraints":[{"message":"Cannot be null property customerId in entity Orders","condition":"isNotNull(customerId)"},{"message":"Cannot be null property employeeId in entity Orders","condition":"isNotNull(employeeId)"},{"message":"Cannot be null property id in entity Orders","condition":"isNotNull(id)"}]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[{"message":"Cannot be null property customerId in entity Orders","condition":"isNotNull(customerId)"},{"message":"Cannot be null property employeeId in entity Orders","condition":"isNotNull(employeeId)"},{"message":"Cannot be null property id in entity Orders","condition":"isNotNull(id)"}]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 2', async () => {
		const expression = 'Orders.update(entity)'
		const modelExpected :any= [{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}]
		const parametersExpected:any = [{"name":"entity.customerId","type":"string"},{"name":"entity.employeeId","type":"integer"},{"name":"entity.orderDate","type":"datetime"},{"name":"entity.requiredDate","type":"date"},{"name":"entity.shippedDate","type":"date"},{"name":"entity.shipViaId","type":"integer"},{"name":"entity.freight","type":"decimal"},{"name":"entity.name","type":"string"},{"name":"entity.address","type":"string"},{"name":"entity.city","type":"string"},{"name":"entity.region","type":"string"},{"name":"entity.postalCode","type":"string"},{"name":"entity.country","type":"string"},{"name":"entity.id","type":"integer"}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"==","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"entity.id","classtype":"Variable","children":[],"type":"integer","number":14}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"customerId","classtype":"KeyValue","children":[{"name":"entity.customerId","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"customerId"},{"name":"employeeId","classtype":"KeyValue","children":[{"name":"entity.employeeId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"employeeId"},{"name":"orderDate","classtype":"KeyValue","children":[{"name":"entity.orderDate","classtype":"Variable","children":[],"type":"datetime","number":3}],"type":"any","property":"orderDate"},{"name":"requiredDate","classtype":"KeyValue","children":[{"name":"entity.requiredDate","classtype":"Variable","children":[],"type":"date","number":4}],"type":"any","property":"requiredDate"},{"name":"shippedDate","classtype":"KeyValue","children":[{"name":"entity.shippedDate","classtype":"Variable","children":[],"type":"date","number":5}],"type":"any","property":"shippedDate"},{"name":"shipViaId","classtype":"KeyValue","children":[{"name":"entity.shipViaId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any","property":"shipViaId"},{"name":"freight","classtype":"KeyValue","children":[{"name":"entity.freight","classtype":"Variable","children":[],"type":"decimal","number":7}],"type":"any","property":"freight"},{"name":"name","classtype":"KeyValue","children":[{"name":"entity.name","classtype":"Variable","children":[],"type":"string","number":8}],"type":"any","property":"name"},{"name":"address","classtype":"KeyValue","children":[{"name":"entity.address","classtype":"Variable","children":[],"type":"string","number":9}],"type":"any","property":"address"},{"name":"city","classtype":"KeyValue","children":[{"name":"entity.city","classtype":"Variable","children":[],"type":"string","number":10}],"type":"any","property":"city"},{"name":"region","classtype":"KeyValue","children":[{"name":"entity.region","classtype":"Variable","children":[],"type":"string","number":11}],"type":"any","property":"region"},{"name":"postalCode","classtype":"KeyValue","children":[{"name":"entity.postalCode","classtype":"Variable","children":[],"type":"string","number":12}],"type":"any","property":"postalCode"},{"name":"country","classtype":"KeyValue","children":[{"name":"entity.country","classtype":"Variable","children":[],"type":"string","number":13}],"type":"any","property":"country"}],"type":"object"}],"type":"any","alias":"o"}],"type":"any","columns":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}],"parameters":[{"name":"entity.customerId","type":"string"},{"name":"entity.employeeId","type":"integer"},{"name":"entity.orderDate","type":"datetime"},{"name":"entity.requiredDate","type":"date"},{"name":"entity.shippedDate","type":"date"},{"name":"entity.shipViaId","type":"integer"},{"name":"entity.freight","type":"decimal"},{"name":"entity.name","type":"string"},{"name":"entity.address","type":"string"},{"name":"entity.city","type":"string"},{"name":"entity.region","type":"string"},{"name":"entity.postalCode","type":"string"},{"name":"entity.country","type":"string"},{"name":"entity.id","type":"integer"}],"entity":"Orders","constraints":[]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 3', async () => {
		const expression = 'Orders.updateAll(=>{postalCode:postalCode})'
		const modelExpected :any= [{"name":"postalCode","type":"string"}]
		const parametersExpected:any = [{"name":"postalCode","type":"string"}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"postalCode","classtype":"KeyValue","children":[{"name":"postalCode","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"postalCode"}],"type":"object"}],"type":"any","alias":"o"}],"type":"any","columns":[{"name":"postalCode","type":"string"}],"parameters":[{"name":"postalCode","type":"string"}],"entity":"Orders","constraints":[]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 4', async () => {
		const expression = 'Orders.update(p=>{name:entity.name}).filter(p=>(p.id===entity.id))'
		const modelExpected :any= [{"name":"name","type":"string"}]
		const parametersExpected:any = [{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"===","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"entity.id","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"name","classtype":"KeyValue","children":[{"name":"entity.name","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"name"}],"type":"object"}],"type":"any","alias":"o"}],"type":"any","columns":[{"name":"name","type":"string"}],"parameters":[{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"}],"entity":"Orders","constraints":[]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 5', async () => {
		const expression = 'Orders.update(=>{name:entity.name}).include(p=>p.details).filter(p=>(p.id===entity.id))'
		const modelExpected :any= [{"name":"name","type":"string"},{"name":"details","type":"Orders.details[]","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}]}]
		const parametersExpected:any = [{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"},{"name":"details","type":"Orders.details","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"},{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}]}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"===","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"entity.id","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"name","classtype":"KeyValue","children":[{"name":"entity.name","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"name"}],"type":"object"}],"type":"any","alias":"o"},{"name":"details","classtype":"SentenceInclude","children":[{"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"&&","classtype":"Operator","children":[{"name":"==","classtype":"Operator","children":[{"name":"orderId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any"},{"name":"==","classtype":"Operator","children":[{"name":"productId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":7}],"type":"any"}],"type":"any"}],"type":"any"},{"name":"Orders.details","classtype":"From","children":[],"type":"any","alias":"o1"},{"name":"Orders.details","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"orderId","classtype":"KeyValue","children":[{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":1}],"type":"any","property":"orderId"},{"name":"productId","classtype":"KeyValue","children":[{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"productId"},{"name":"unitPrice","classtype":"KeyValue","children":[{"name":"unitPrice","classtype":"Variable","children":[],"type":"decimal","number":3}],"type":"any","property":"unitPrice"},{"name":"quantity","classtype":"KeyValue","children":[{"name":"quantity","classtype":"Variable","children":[],"type":"decimal","number":4}],"type":"any","property":"quantity"},{"name":"discount","classtype":"KeyValue","children":[{"name":"discount","classtype":"Variable","children":[],"type":"decimal","number":5}],"type":"any","property":"discount"}],"type":"object"}],"type":"any","alias":"o1"}],"type":"any","columns":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}],"parameters":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"},{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}],"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"},{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}],"type":"any","relation":{"name":"details","type":"manyToOne","composite":true,"from":"id","entity":"Orders.details","weak":true,"to":"orderId","target":"order"}}],"type":"any","columns":[{"name":"name","type":"string"}],"parameters":[{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"}],"entity":"Orders","constraints":[]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[],"children":[{"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"},{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 6', async () => {
		const expression = 'Orders.update(=>{name:entity.name}).include(p=>p.details.update(p=>p)).filter(p=>(p.id===entity.id))'
		const modelExpected :any= [{"name":"name","type":"string"},{"name":"details","type":"Orders.details[]","children":[{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}]}]
		const parametersExpected:any = [{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"},{"name":"details","type":"Orders.details","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}]}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"===","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"entity.id","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"name","classtype":"KeyValue","children":[{"name":"entity.name","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"name"}],"type":"object"}],"type":"any","alias":"o"},{"name":"details","classtype":"SentenceInclude","children":[{"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"&&","classtype":"Operator","children":[{"name":"==","classtype":"Operator","children":[{"name":"orderId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":1}],"type":"any"},{"name":"==","classtype":"Operator","children":[{"name":"productId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any"}],"type":"any"}],"type":"any"},{"name":"Orders.details","classtype":"From","children":[],"type":"any","alias":"o1"},{"name":"Orders.details","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"unitPrice","classtype":"KeyValue","children":[{"name":"unitPrice","classtype":"Field","children":[],"type":"decimal","entity":"Orders.details","alias":"o1","isRoot":true}],"type":"any","property":"unitPrice"},{"name":"quantity","classtype":"KeyValue","children":[{"name":"quantity","classtype":"Field","children":[],"type":"decimal","entity":"Orders.details","alias":"o1","isRoot":true}],"type":"any","property":"quantity"},{"name":"discount","classtype":"KeyValue","children":[{"name":"discount","classtype":"Field","children":[],"type":"decimal","entity":"Orders.details","alias":"o1","isRoot":true}],"type":"any","property":"discount"}],"type":"object"}],"type":"any","alias":"o1"}],"type":"any","columns":[{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}],"parameters":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}],"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}],"type":"any","relation":{"name":"details","type":"manyToOne","composite":true,"from":"id","entity":"Orders.details","weak":true,"to":"orderId","target":"order"}}],"type":"any","columns":[{"name":"name","type":"string"}],"parameters":[{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"}],"entity":"Orders","constraints":[]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[],"children":[{"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 7', async () => {
		const expression = 'Orders.update(=>{name:entity.name}).include(p=>p.details.update(p=>{unitPrice:p.unitPrice,productId:p.productId})).filter(p=>(p.id===entity.id))'
		const modelExpected :any= [{"name":"name","type":"string"},{"name":"details","type":"Orders.details[]","children":[{"name":"unitPrice","type":"decimal"},{"name":"productId","type":"integer"}]}]
		const parametersExpected:any = [{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"},{"name":"details","type":"Orders.details","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}]}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"===","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"entity.id","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"name","classtype":"KeyValue","children":[{"name":"entity.name","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"name"}],"type":"object"}],"type":"any","alias":"o"},{"name":"details","classtype":"SentenceInclude","children":[{"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"&&","classtype":"Operator","children":[{"name":"==","classtype":"Operator","children":[{"name":"orderId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":1}],"type":"any"},{"name":"==","classtype":"Operator","children":[{"name":"productId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any"}],"type":"any"}],"type":"any"},{"name":"Orders.details","classtype":"From","children":[],"type":"any","alias":"o1"},{"name":"Orders.details","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"unitPrice","classtype":"KeyValue","children":[{"name":"unitPrice","classtype":"Field","children":[],"type":"decimal","entity":"Orders.details","alias":"o1","isRoot":true}],"type":"any","property":"unitPrice"},{"name":"productId","classtype":"KeyValue","children":[{"name":"productId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true}],"type":"any","property":"productId"}],"type":"object"}],"type":"any","alias":"o1"}],"type":"any","columns":[{"name":"unitPrice","type":"decimal"},{"name":"productId","type":"integer"}],"parameters":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}],"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}],"type":"any","relation":{"name":"details","type":"manyToOne","composite":true,"from":"id","entity":"Orders.details","weak":true,"to":"orderId","target":"order"}}],"type":"any","columns":[{"name":"name","type":"string"}],"parameters":[{"name":"entity.name","type":"string"},{"name":"entity.id","type":"integer"}],"entity":"Orders","constraints":[]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[],"children":[{"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 8', async () => {
		const expression = 'Orders.update().include(p=>p.details)'
		const modelExpected :any= [{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"details","type":"Orders.details[]","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}]}]
		const parametersExpected:any = [{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"integer"},{"name":"details","type":"Orders.details","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"},{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}]}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"==","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"id","classtype":"Variable","children":[],"type":"integer","number":14}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"customerId","classtype":"KeyValue","children":[{"name":"customerId","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"customerId"},{"name":"employeeId","classtype":"KeyValue","children":[{"name":"employeeId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"employeeId"},{"name":"orderDate","classtype":"KeyValue","children":[{"name":"orderDate","classtype":"Variable","children":[],"type":"datetime","number":3}],"type":"any","property":"orderDate"},{"name":"requiredDate","classtype":"KeyValue","children":[{"name":"requiredDate","classtype":"Variable","children":[],"type":"date","number":4}],"type":"any","property":"requiredDate"},{"name":"shippedDate","classtype":"KeyValue","children":[{"name":"shippedDate","classtype":"Variable","children":[],"type":"date","number":5}],"type":"any","property":"shippedDate"},{"name":"shipViaId","classtype":"KeyValue","children":[{"name":"shipViaId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any","property":"shipViaId"},{"name":"freight","classtype":"KeyValue","children":[{"name":"freight","classtype":"Variable","children":[],"type":"decimal","number":7}],"type":"any","property":"freight"},{"name":"name","classtype":"KeyValue","children":[{"name":"name","classtype":"Variable","children":[],"type":"string","number":8}],"type":"any","property":"name"},{"name":"address","classtype":"KeyValue","children":[{"name":"address","classtype":"Variable","children":[],"type":"string","number":9}],"type":"any","property":"address"},{"name":"city","classtype":"KeyValue","children":[{"name":"city","classtype":"Variable","children":[],"type":"string","number":10}],"type":"any","property":"city"},{"name":"region","classtype":"KeyValue","children":[{"name":"region","classtype":"Variable","children":[],"type":"string","number":11}],"type":"any","property":"region"},{"name":"postalCode","classtype":"KeyValue","children":[{"name":"postalCode","classtype":"Variable","children":[],"type":"string","number":12}],"type":"any","property":"postalCode"},{"name":"country","classtype":"KeyValue","children":[{"name":"country","classtype":"Variable","children":[],"type":"string","number":13}],"type":"any","property":"country"}],"type":"object"}],"type":"any","alias":"o"},{"name":"details","classtype":"SentenceInclude","children":[{"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"&&","classtype":"Operator","children":[{"name":"==","classtype":"Operator","children":[{"name":"orderId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any"},{"name":"==","classtype":"Operator","children":[{"name":"productId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":7}],"type":"any"}],"type":"any"}],"type":"any"},{"name":"Orders.details","classtype":"From","children":[],"type":"any","alias":"o1"},{"name":"Orders.details","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"orderId","classtype":"KeyValue","children":[{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":1}],"type":"any","property":"orderId"},{"name":"productId","classtype":"KeyValue","children":[{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"productId"},{"name":"unitPrice","classtype":"KeyValue","children":[{"name":"unitPrice","classtype":"Variable","children":[],"type":"decimal","number":3}],"type":"any","property":"unitPrice"},{"name":"quantity","classtype":"KeyValue","children":[{"name":"quantity","classtype":"Variable","children":[],"type":"decimal","number":4}],"type":"any","property":"quantity"},{"name":"discount","classtype":"KeyValue","children":[{"name":"discount","classtype":"Variable","children":[],"type":"decimal","number":5}],"type":"any","property":"discount"}],"type":"object"}],"type":"any","alias":"o1"}],"type":"any","columns":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}],"parameters":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"},{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}],"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"},{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}],"type":"any","relation":{"name":"details","type":"manyToOne","composite":true,"from":"id","entity":"Orders.details","weak":true,"to":"orderId","target":"order"}}],"type":"any","columns":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}],"parameters":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"integer"}],"entity":"Orders","constraints":[{"message":"Cannot be null property customerId in entity Orders","condition":"isNotNull(customerId)"},{"message":"Cannot be null property employeeId in entity Orders","condition":"isNotNull(employeeId)"},{"message":"Cannot be null property id in entity Orders","condition":"isNotNull(id)"}]}
		const constraintsExpected :any= {"entity":"Orders","constraints":[{"message":"Cannot be null property customerId in entity Orders","condition":"isNotNull(customerId)"},{"message":"Cannot be null property employeeId in entity Orders","condition":"isNotNull(employeeId)"},{"message":"Cannot be null property id in entity Orders","condition":"isNotNull(id)"}],"children":[{"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"},{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
	test('update 9', async () => {
		const expression = 'Customers.update().include(p=>p.orders.include(p=>p.details))'
		const modelExpected :any= [{"name":"id","type":"string"},{"name":"name","type":"string"},{"name":"contact","type":"string"},{"name":"phone","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"orders","type":"Orders[]","children":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"details","type":"Orders.details[]","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}]}]}]
		const parametersExpected:any = [{"name":"id","type":"string"},{"name":"name","type":"string"},{"name":"contact","type":"string"},{"name":"phone","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"string"},{"name":"orders","type":"Orders","children":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"integer"},{"name":"details","type":"Orders.details","children":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"},{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}]}]}]
		const metadataExpected :any= {"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"==","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"string","entity":"Customers","alias":"c","isRoot":true},{"name":"id","classtype":"Variable","children":[],"type":"string","number":10}],"type":"any"}],"type":"any"},{"name":"Customers","classtype":"From","children":[],"type":"any","alias":"c"},{"name":"Customers","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"id","classtype":"KeyValue","children":[{"name":"id","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"id"},{"name":"name","classtype":"KeyValue","children":[{"name":"name","classtype":"Variable","children":[],"type":"string","number":2}],"type":"any","property":"name"},{"name":"contact","classtype":"KeyValue","children":[{"name":"contact","classtype":"Variable","children":[],"type":"string","number":3}],"type":"any","property":"contact"},{"name":"phone","classtype":"KeyValue","children":[{"name":"phone","classtype":"Variable","children":[],"type":"string","number":4}],"type":"any","property":"phone"},{"name":"address","classtype":"KeyValue","children":[{"name":"address","classtype":"Variable","children":[],"type":"string","number":5}],"type":"any","property":"address"},{"name":"city","classtype":"KeyValue","children":[{"name":"city","classtype":"Variable","children":[],"type":"string","number":6}],"type":"any","property":"city"},{"name":"region","classtype":"KeyValue","children":[{"name":"region","classtype":"Variable","children":[],"type":"string","number":7}],"type":"any","property":"region"},{"name":"postalCode","classtype":"KeyValue","children":[{"name":"postalCode","classtype":"Variable","children":[],"type":"string","number":8}],"type":"any","property":"postalCode"},{"name":"country","classtype":"KeyValue","children":[{"name":"country","classtype":"Variable","children":[],"type":"string","number":9}],"type":"any","property":"country"}],"type":"object"}],"type":"any","alias":"c"},{"name":"orders","classtype":"SentenceInclude","children":[{"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"==","classtype":"Operator","children":[{"name":"id","classtype":"Field","children":[],"type":"integer","entity":"Orders","alias":"o","isRoot":true},{"name":"id","classtype":"Variable","children":[],"type":"integer","number":14}],"type":"any"}],"type":"any"},{"name":"Orders","classtype":"From","children":[],"type":"any","alias":"o"},{"name":"Orders","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"customerId","classtype":"KeyValue","children":[{"name":"customerId","classtype":"Variable","children":[],"type":"string","number":1}],"type":"any","property":"customerId"},{"name":"employeeId","classtype":"KeyValue","children":[{"name":"employeeId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"employeeId"},{"name":"orderDate","classtype":"KeyValue","children":[{"name":"orderDate","classtype":"Variable","children":[],"type":"datetime","number":3}],"type":"any","property":"orderDate"},{"name":"requiredDate","classtype":"KeyValue","children":[{"name":"requiredDate","classtype":"Variable","children":[],"type":"date","number":4}],"type":"any","property":"requiredDate"},{"name":"shippedDate","classtype":"KeyValue","children":[{"name":"shippedDate","classtype":"Variable","children":[],"type":"date","number":5}],"type":"any","property":"shippedDate"},{"name":"shipViaId","classtype":"KeyValue","children":[{"name":"shipViaId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any","property":"shipViaId"},{"name":"freight","classtype":"KeyValue","children":[{"name":"freight","classtype":"Variable","children":[],"type":"decimal","number":7}],"type":"any","property":"freight"},{"name":"name","classtype":"KeyValue","children":[{"name":"name","classtype":"Variable","children":[],"type":"string","number":8}],"type":"any","property":"name"},{"name":"address","classtype":"KeyValue","children":[{"name":"address","classtype":"Variable","children":[],"type":"string","number":9}],"type":"any","property":"address"},{"name":"city","classtype":"KeyValue","children":[{"name":"city","classtype":"Variable","children":[],"type":"string","number":10}],"type":"any","property":"city"},{"name":"region","classtype":"KeyValue","children":[{"name":"region","classtype":"Variable","children":[],"type":"string","number":11}],"type":"any","property":"region"},{"name":"postalCode","classtype":"KeyValue","children":[{"name":"postalCode","classtype":"Variable","children":[],"type":"string","number":12}],"type":"any","property":"postalCode"},{"name":"country","classtype":"KeyValue","children":[{"name":"country","classtype":"Variable","children":[],"type":"string","number":13}],"type":"any","property":"country"}],"type":"object"}],"type":"any","alias":"o"},{"name":"details","classtype":"SentenceInclude","children":[{"name":"update","classtype":"Sentence","children":[{"name":"filter","classtype":"Filter","children":[{"name":"&&","classtype":"Operator","children":[{"name":"==","classtype":"Operator","children":[{"name":"orderId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":6}],"type":"any"},{"name":"==","classtype":"Operator","children":[{"name":"productId","classtype":"Field","children":[],"type":"integer","entity":"Orders.details","alias":"o1","isRoot":true},{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":7}],"type":"any"}],"type":"any"}],"type":"any"},{"name":"Orders.details","classtype":"From","children":[],"type":"any","alias":"o1"},{"name":"Orders.details","classtype":"Update","children":[{"name":"obj","classtype":"Obj","children":[{"name":"orderId","classtype":"KeyValue","children":[{"name":"orderId","classtype":"Variable","children":[],"type":"integer","number":1}],"type":"any","property":"orderId"},{"name":"productId","classtype":"KeyValue","children":[{"name":"productId","classtype":"Variable","children":[],"type":"integer","number":2}],"type":"any","property":"productId"},{"name":"unitPrice","classtype":"KeyValue","children":[{"name":"unitPrice","classtype":"Variable","children":[],"type":"decimal","number":3}],"type":"any","property":"unitPrice"},{"name":"quantity","classtype":"KeyValue","children":[{"name":"quantity","classtype":"Variable","children":[],"type":"decimal","number":4}],"type":"any","property":"quantity"},{"name":"discount","classtype":"KeyValue","children":[{"name":"discount","classtype":"Variable","children":[],"type":"decimal","number":5}],"type":"any","property":"discount"}],"type":"object"}],"type":"any","alias":"o1"}],"type":"any","columns":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"}],"parameters":[{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"},{"name":"unitPrice","type":"decimal"},{"name":"quantity","type":"decimal"},{"name":"discount","type":"decimal"},{"name":"orderId","type":"integer"},{"name":"productId","type":"integer"}],"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"},{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}],"type":"any","relation":{"name":"details","type":"manyToOne","composite":true,"from":"id","entity":"Orders.details","weak":true,"to":"orderId","target":"order"}}],"type":"any","columns":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}],"parameters":[{"name":"customerId","type":"string"},{"name":"employeeId","type":"integer"},{"name":"orderDate","type":"datetime"},{"name":"requiredDate","type":"date"},{"name":"shippedDate","type":"date"},{"name":"shipViaId","type":"integer"},{"name":"freight","type":"decimal"},{"name":"name","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"integer"}],"entity":"Orders","constraints":[{"message":"Cannot be null property customerId in entity Orders","condition":"isNotNull(customerId)"},{"message":"Cannot be null property employeeId in entity Orders","condition":"isNotNull(employeeId)"},{"message":"Cannot be null property id in entity Orders","condition":"isNotNull(id)"}]}],"type":"any","relation":{"name":"orders","type":"manyToOne","composite":false,"from":"id","entity":"Orders","weak":true,"to":"customerId","target":"customer"}}],"type":"any","columns":[{"name":"id","type":"string"},{"name":"name","type":"string"},{"name":"contact","type":"string"},{"name":"phone","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"}],"parameters":[{"name":"id","type":"string"},{"name":"name","type":"string"},{"name":"contact","type":"string"},{"name":"phone","type":"string"},{"name":"address","type":"string"},{"name":"city","type":"string"},{"name":"region","type":"string"},{"name":"postalCode","type":"string"},{"name":"country","type":"string"},{"name":"id","type":"string"}],"entity":"Customers","constraints":[{"message":"Cannot be null property id in entity Customers","condition":"isNotNull(id)"},{"message":"Cannot be null property name in entity Customers","condition":"isNotNull(name)"},{"message":"Cannot be null property id in entity Customers","condition":"isNotNull(id)"}]}
		const constraintsExpected :any= {"entity":"Customers","constraints":[{"message":"Cannot be null property id in entity Customers","condition":"isNotNull(id)"},{"message":"Cannot be null property name in entity Customers","condition":"isNotNull(name)"},{"message":"Cannot be null property id in entity Customers","condition":"isNotNull(id)"}],"children":[{"entity":"Orders","constraints":[{"message":"Cannot be null property customerId in entity Orders","condition":"isNotNull(customerId)"},{"message":"Cannot be null property employeeId in entity Orders","condition":"isNotNull(employeeId)"},{"message":"Cannot be null property id in entity Orders","condition":"isNotNull(id)"}],"children":[{"entity":"Orders.details","constraints":[{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"},{"message":"Cannot be null property orderId in entity Orders.details","condition":"isNotNull(orderId)"},{"message":"Cannot be null property productId in entity Orders.details","condition":"isNotNull(productId)"}]}]}]}
		const model = orm.model(expression)
		const parameters = orm.parameters(expression)
		const constraints = orm.constraints(expression)
		const metadata = orm.metadata(expression)
		expect(modelExpected).toStrictEqual(model)
		expect(metadataExpected.columns).toStrictEqual(metadata.columns)
		expect(parametersExpected).toStrictEqual(parameters)
		expect(constraintsExpected).toStrictEqual(constraints)
	})
})
describe('Sentences', () => {
	test('update 1', async () => {
		const expression = 'Orders.update()'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET CustomerID = $1,EmployeeID = $2,OrderDate = $3,RequiredDate = $4,ShippedDate = $5,ShipVia = $6,Freight = $7,ShipName = $8,ShipAddress = $9,ShipCity = $10,ShipRegion = $11,ShipPostalCode = $12,ShipCountry = $13 WHERE o.OrderID = $14 ","children":[]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET CustomerID = @customerId,EmployeeID = @employeeId,OrderDate = @orderDate,RequiredDate = @requiredDate,ShippedDate = @shippedDate,ShipVia = @shipViaId,Freight = @freight,ShipName = @name,ShipAddress = @address,ShipCity = @city,ShipRegion = @region,ShipPostalCode = @postalCode,ShipCountry = @country FROM Orders o WHERE o.OrderID = @id ","children":[]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET CustomerID = :customerId,EmployeeID = :employeeId,OrderDate = :orderDate,RequiredDate = :requiredDate,ShippedDate = :shippedDate,ShipVia = :shipViaId,Freight = :freight,ShipName = :name,ShipAddress = :address,ShipCity = :city,ShipRegion = :region,ShipPostalCode = :postalCode,ShipCountry = :country WHERE o.OrderID = :id ","children":[]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"CustomerID\\\":{{customerId}},\\\"EmployeeID\\\":{{employeeId}},\\\"OrderDate\\\":{{orderDate}},\\\"RequiredDate\\\":{{requiredDate}},\\\"ShippedDate\\\":{{shippedDate}},\\\"ShipVia\\\":{{shipViaId}},\\\"Freight\\\":{{freight}},\\\"ShipName\\\":{{name}},\\\"ShipAddress\\\":{{address}},\\\"ShipCity\\\":{{city}},\\\"ShipRegion\\\":{{region}},\\\"ShipPostalCode\\\":{{postalCode}},\\\"ShipCountry\\\":{{country}} }}\",\"filter\":\"{ \\\"_id\\\":{{id}} }\"}","children":[]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 2', async () => {
		const expression = 'Orders.update(entity)'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET CustomerID = $1,EmployeeID = $2,OrderDate = $3,RequiredDate = $4,ShippedDate = $5,ShipVia = $6,Freight = $7,ShipName = $8,ShipAddress = $9,ShipCity = $10,ShipRegion = $11,ShipPostalCode = $12,ShipCountry = $13 WHERE o.OrderID = $14 ","children":[]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET CustomerID = @entity_customerId,EmployeeID = @entity_employeeId,OrderDate = @entity_orderDate,RequiredDate = @entity_requiredDate,ShippedDate = @entity_shippedDate,ShipVia = @entity_shipViaId,Freight = @entity_freight,ShipName = @entity_name,ShipAddress = @entity_address,ShipCity = @entity_city,ShipRegion = @entity_region,ShipPostalCode = @entity_postalCode,ShipCountry = @entity_country FROM Orders o WHERE o.OrderID = @entity_id ","children":[]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET CustomerID = :entity_customerId,EmployeeID = :entity_employeeId,OrderDate = :entity_orderDate,RequiredDate = :entity_requiredDate,ShippedDate = :entity_shippedDate,ShipVia = :entity_shipViaId,Freight = :entity_freight,ShipName = :entity_name,ShipAddress = :entity_address,ShipCity = :entity_city,ShipRegion = :entity_region,ShipPostalCode = :entity_postalCode,ShipCountry = :entity_country WHERE o.OrderID = :entity_id ","children":[]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"CustomerID\\\":{{entity_customerId}},\\\"EmployeeID\\\":{{entity_employeeId}},\\\"OrderDate\\\":{{entity_orderDate}},\\\"RequiredDate\\\":{{entity_requiredDate}},\\\"ShippedDate\\\":{{entity_shippedDate}},\\\"ShipVia\\\":{{entity_shipViaId}},\\\"Freight\\\":{{entity_freight}},\\\"ShipName\\\":{{entity_name}},\\\"ShipAddress\\\":{{entity_address}},\\\"ShipCity\\\":{{entity_city}},\\\"ShipRegion\\\":{{entity_region}},\\\"ShipPostalCode\\\":{{entity_postalCode}},\\\"ShipCountry\\\":{{entity_country}} }}\",\"filter\":\"{ \\\"_id\\\":{{entity_id}} }\"}","children":[]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 3', async () => {
		const expression = 'Orders.updateAll(=>{postalCode:postalCode})'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET ShipPostalCode = ? ","children":[]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET ShipPostalCode = ? ","children":[]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET ShipPostalCode = $1 ","children":[]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET ShipPostalCode = @postalCode FROM Orders o ","children":[]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET ShipPostalCode = :postalCode ","children":[]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"ShipPostalCode\\\":{{postalCode}} }}\",\"filter\":{}}","children":[]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 4', async () => {
		const expression = 'Orders.update(p=>{name:entity.name}).filter(p=>(p.id===entity.id))'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET ShipName = $1 WHERE o.OrderID = $2 ","children":[]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET ShipName = @entity_name FROM Orders o WHERE o.OrderID = @entity_id ","children":[]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET ShipName = :entity_name WHERE o.OrderID = :entity_id ","children":[]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"ShipName\\\":{{entity_name}} }}\",\"filter\":\"{ \\\"_id\\\":{{entity_id}} }\"}","children":[]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 5', async () => {
		const expression = 'Orders.update(=>{name:entity.name}).include(p=>p.details).filter(p=>(p.id===entity.id))'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MySQL","source":"MySQL","sentence":"UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET ShipName = $1 WHERE o.OrderID = $2 ","children":[{"entity":"Orders.details","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE \"Order Details\" o1 SET OrderID = $1,ProductID = $2,UnitPrice = $3,Quantity = $4,Discount = $5 WHERE (o1.OrderID = $6 AND o1.ProductID = $7) ","children":[]}]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET ShipName = @entity_name FROM Orders o WHERE o.OrderID = @entity_id ","children":[{"entity":"Orders.details","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o1 SET OrderID = @orderId,ProductID = @productId,UnitPrice = @unitPrice,Quantity = @quantity,Discount = @discount FROM [Order Details] o1 WHERE (o1.OrderID = @orderId AND o1.ProductID = @productId) ","children":[]}]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET ShipName = :entity_name WHERE o.OrderID = :entity_id ","children":[{"entity":"Orders.details","dialect":"Oracle","source":"Oracle","sentence":"UPDATE \"Order Details\" o1 SET OrderID = :orderId,ProductID = :productId,UnitPrice = :unitPrice,Quantity = :quantity,Discount = :discount WHERE (o1.OrderID = :orderId AND o1.ProductID = :productId) ","children":[]}]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"ShipName\\\":{{entity_name}} }}\",\"filter\":\"{ \\\"_id\\\":{{entity_id}} }\"}","children":[{"entity":"Orders.details","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"OrderID\\\":{{orderId}},\\\"ProductID\\\":{{productId}},\\\"UnitPrice\\\":{{unitPrice}},\\\"Quantity\\\":{{quantity}},\\\"Discount\\\":{{discount}} }}\",\"filter\":\"{ \\\"$and\\\" :[{ \\\"OrderID\\\":{{orderId}} },{ \\\"ProductID\\\":{{productId}} }] }\"}","children":[]}]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 6', async () => {
		const expression = 'Orders.update(=>{name:entity.name}).include(p=>p.details.update(p=>p)).filter(p=>(p.id===entity.id))'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MySQL","source":"MySQL","sentence":"UPDATE `Order Details` o1 SET UnitPrice = o1.UnitPrice,Quantity = o1.Quantity,Discount = o1.Discount WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE `Order Details` o1 SET UnitPrice = o1.UnitPrice,Quantity = o1.Quantity,Discount = o1.Discount WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET ShipName = $1 WHERE o.OrderID = $2 ","children":[{"entity":"Orders.details","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE \"Order Details\" o1 SET UnitPrice = o1.UnitPrice,Quantity = o1.Quantity,Discount = o1.Discount WHERE (o1.OrderID = $1 AND o1.ProductID = $2) ","children":[]}]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET ShipName = @entity_name FROM Orders o WHERE o.OrderID = @entity_id ","children":[{"entity":"Orders.details","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o1 SET UnitPrice = o1.UnitPrice,Quantity = o1.Quantity,Discount = o1.Discount FROM [Order Details] o1 WHERE (o1.OrderID = @orderId AND o1.ProductID = @productId) ","children":[]}]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET ShipName = :entity_name WHERE o.OrderID = :entity_id ","children":[{"entity":"Orders.details","dialect":"Oracle","source":"Oracle","sentence":"UPDATE \"Order Details\" o1 SET UnitPrice = o1.UnitPrice,Quantity = o1.Quantity,Discount = o1.Discount WHERE (o1.OrderID = :orderId AND o1.ProductID = :productId) ","children":[]}]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"ShipName\\\":{{entity_name}} }}\",\"filter\":\"{ \\\"_id\\\":{{entity_id}} }\"}","children":[{"entity":"Orders.details","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"UnitPrice\\\":\\\"UnitPrice\\\",\\\"Quantity\\\":\\\"Quantity\\\",\\\"Discount\\\":\\\"Discount\\\" }}\",\"filter\":\"{ \\\"$and\\\" :[{ \\\"OrderID\\\":{{orderId}} },{ \\\"ProductID\\\":{{productId}} }] }\"}","children":[]}]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 7', async () => {
		const expression = 'Orders.update(=>{name:entity.name}).include(p=>p.details.update(p=>{unitPrice:p.unitPrice,productId:p.productId})).filter(p=>(p.id===entity.id))'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MySQL","source":"MySQL","sentence":"UPDATE `Order Details` o1 SET UnitPrice = o1.UnitPrice,ProductID = o1.ProductID WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE `Order Details` o1 SET UnitPrice = o1.UnitPrice,ProductID = o1.ProductID WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET ShipName = $1 WHERE o.OrderID = $2 ","children":[{"entity":"Orders.details","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE \"Order Details\" o1 SET UnitPrice = o1.UnitPrice,ProductID = o1.ProductID WHERE (o1.OrderID = $1 AND o1.ProductID = $2) ","children":[]}]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET ShipName = @entity_name FROM Orders o WHERE o.OrderID = @entity_id ","children":[{"entity":"Orders.details","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o1 SET UnitPrice = o1.UnitPrice,ProductID = o1.ProductID FROM [Order Details] o1 WHERE (o1.OrderID = @orderId AND o1.ProductID = @productId) ","children":[]}]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET ShipName = :entity_name WHERE o.OrderID = :entity_id ","children":[{"entity":"Orders.details","dialect":"Oracle","source":"Oracle","sentence":"UPDATE \"Order Details\" o1 SET UnitPrice = o1.UnitPrice,ProductID = o1.ProductID WHERE (o1.OrderID = :orderId AND o1.ProductID = :productId) ","children":[]}]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"ShipName\\\":{{entity_name}} }}\",\"filter\":\"{ \\\"_id\\\":{{entity_id}} }\"}","children":[{"entity":"Orders.details","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"UnitPrice\\\":\\\"UnitPrice\\\",\\\"ProductID\\\":\\\"ProductID\\\" }}\",\"filter\":\"{ \\\"$and\\\" :[{ \\\"OrderID\\\":{{orderId}} },{ \\\"ProductID\\\":{{productId}} }] }\"}","children":[]}]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 8', async () => {
		const expression = 'Orders.update().include(p=>p.details)'
		const MySQLExpected = {"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MySQL","source":"MySQL","sentence":"UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET CustomerID = $1,EmployeeID = $2,OrderDate = $3,RequiredDate = $4,ShippedDate = $5,ShipVia = $6,Freight = $7,ShipName = $8,ShipAddress = $9,ShipCity = $10,ShipRegion = $11,ShipPostalCode = $12,ShipCountry = $13 WHERE o.OrderID = $14 ","children":[{"entity":"Orders.details","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE \"Order Details\" o1 SET OrderID = $1,ProductID = $2,UnitPrice = $3,Quantity = $4,Discount = $5 WHERE (o1.OrderID = $6 AND o1.ProductID = $7) ","children":[]}]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET CustomerID = @customerId,EmployeeID = @employeeId,OrderDate = @orderDate,RequiredDate = @requiredDate,ShippedDate = @shippedDate,ShipVia = @shipViaId,Freight = @freight,ShipName = @name,ShipAddress = @address,ShipCity = @city,ShipRegion = @region,ShipPostalCode = @postalCode,ShipCountry = @country FROM Orders o WHERE o.OrderID = @id ","children":[{"entity":"Orders.details","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o1 SET OrderID = @orderId,ProductID = @productId,UnitPrice = @unitPrice,Quantity = @quantity,Discount = @discount FROM [Order Details] o1 WHERE (o1.OrderID = @orderId AND o1.ProductID = @productId) ","children":[]}]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET CustomerID = :customerId,EmployeeID = :employeeId,OrderDate = :orderDate,RequiredDate = :requiredDate,ShippedDate = :shippedDate,ShipVia = :shipViaId,Freight = :freight,ShipName = :name,ShipAddress = :address,ShipCity = :city,ShipRegion = :region,ShipPostalCode = :postalCode,ShipCountry = :country WHERE o.OrderID = :id ","children":[{"entity":"Orders.details","dialect":"Oracle","source":"Oracle","sentence":"UPDATE \"Order Details\" o1 SET OrderID = :orderId,ProductID = :productId,UnitPrice = :unitPrice,Quantity = :quantity,Discount = :discount WHERE (o1.OrderID = :orderId AND o1.ProductID = :productId) ","children":[]}]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"CustomerID\\\":{{customerId}},\\\"EmployeeID\\\":{{employeeId}},\\\"OrderDate\\\":{{orderDate}},\\\"RequiredDate\\\":{{requiredDate}},\\\"ShippedDate\\\":{{shippedDate}},\\\"ShipVia\\\":{{shipViaId}},\\\"Freight\\\":{{freight}},\\\"ShipName\\\":{{name}},\\\"ShipAddress\\\":{{address}},\\\"ShipCity\\\":{{city}},\\\"ShipRegion\\\":{{region}},\\\"ShipPostalCode\\\":{{postalCode}},\\\"ShipCountry\\\":{{country}} }}\",\"filter\":\"{ \\\"_id\\\":{{id}} }\"}","children":[{"entity":"Orders.details","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"OrderID\\\":{{orderId}},\\\"ProductID\\\":{{productId}},\\\"UnitPrice\\\":{{unitPrice}},\\\"Quantity\\\":{{quantity}},\\\"Discount\\\":{{discount}} }}\",\"filter\":\"{ \\\"$and\\\" :[{ \\\"OrderID\\\":{{orderId}} },{ \\\"ProductID\\\":{{productId}} }] }\"}","children":[]}]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
	test('update 9', async () => {
		const expression = 'Customers.update().include(p=>p.orders.include(p=>p.details))'
		const MySQLExpected = {"entity":"Customers","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Customers c SET CustomerID = ?,CompanyName = ?,ContactName = ?,ContactTitle = ?,Address = ?,City = ?,Region = ?,PostalCode = ?,Country = ? WHERE c.CustomerID = ? ","children":[{"entity":"Orders","dialect":"MySQL","source":"MySQL","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MySQL","source":"MySQL","sentence":"UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}]}
		let MySQL = orm.sentence(expression,{stage:'MySQL'})
		expect(MySQLExpected).toStrictEqual(MySQL)
		const MariaDBExpected = {"entity":"Customers","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Customers c SET CustomerID = ?,CompanyName = ?,ContactName = ?,ContactTitle = ?,Address = ?,City = ?,Region = ?,PostalCode = ?,Country = ? WHERE c.CustomerID = ? ","children":[{"entity":"Orders","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? WHERE o.OrderID = ? ","children":[{"entity":"Orders.details","dialect":"MariaDB","source":"MariaDB","sentence":"UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? WHERE (o1.OrderID = ? AND o1.ProductID = ?) ","children":[]}]}]}
		let MariaDB = orm.sentence(expression,{stage:'MariaDB'})
		expect(MariaDBExpected).toStrictEqual(MariaDB)
		const PostgreSQLExpected = {"entity":"Customers","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Customers c SET CustomerID = $1,CompanyName = $2,ContactName = $3,ContactTitle = $4,Address = $5,City = $6,Region = $7,PostalCode = $8,Country = $9 WHERE c.CustomerID = $10 ","children":[{"entity":"Orders","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE Orders o SET CustomerID = $1,EmployeeID = $2,OrderDate = $3,RequiredDate = $4,ShippedDate = $5,ShipVia = $6,Freight = $7,ShipName = $8,ShipAddress = $9,ShipCity = $10,ShipRegion = $11,ShipPostalCode = $12,ShipCountry = $13 WHERE o.OrderID = $14 ","children":[{"entity":"Orders.details","dialect":"PostgreSQL","source":"PostgreSQL","sentence":"UPDATE \"Order Details\" o1 SET OrderID = $1,ProductID = $2,UnitPrice = $3,Quantity = $4,Discount = $5 WHERE (o1.OrderID = $6 AND o1.ProductID = $7) ","children":[]}]}]}
		let PostgreSQL = orm.sentence(expression,{stage:'PostgreSQL'})
		expect(PostgreSQLExpected).toStrictEqual(PostgreSQL)
		const SqlServerExpected = {"entity":"Customers","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE c SET CustomerID = @id,CompanyName = @name,ContactName = @contact,ContactTitle = @phone,Address = @address,City = @city,Region = @region,PostalCode = @postalCode,Country = @country FROM Customers c WHERE c.CustomerID = @id ","children":[{"entity":"Orders","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o SET CustomerID = @customerId,EmployeeID = @employeeId,OrderDate = @orderDate,RequiredDate = @requiredDate,ShippedDate = @shippedDate,ShipVia = @shipViaId,Freight = @freight,ShipName = @name,ShipAddress = @address,ShipCity = @city,ShipRegion = @region,ShipPostalCode = @postalCode,ShipCountry = @country FROM Orders o WHERE o.OrderID = @id ","children":[{"entity":"Orders.details","dialect":"SqlServer","source":"SqlServer","sentence":"UPDATE o1 SET OrderID = @orderId,ProductID = @productId,UnitPrice = @unitPrice,Quantity = @quantity,Discount = @discount FROM [Order Details] o1 WHERE (o1.OrderID = @orderId AND o1.ProductID = @productId) ","children":[]}]}]}
		let SqlServer = orm.sentence(expression,{stage:'SqlServer'})
		expect(SqlServerExpected).toStrictEqual(SqlServer)
		const OracleExpected = {"entity":"Customers","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Customers c SET CustomerID = :id,CompanyName = :name,ContactName = :contact,ContactTitle = :phone,Address = :address,City = :city,Region = :region,PostalCode = :postalCode,Country = :country WHERE c.CustomerID = :id ","children":[{"entity":"Orders","dialect":"Oracle","source":"Oracle","sentence":"UPDATE Orders o SET CustomerID = :customerId,EmployeeID = :employeeId,OrderDate = :orderDate,RequiredDate = :requiredDate,ShippedDate = :shippedDate,ShipVia = :shipViaId,Freight = :freight,ShipName = :name,ShipAddress = :address,ShipCity = :city,ShipRegion = :region,ShipPostalCode = :postalCode,ShipCountry = :country WHERE o.OrderID = :id ","children":[{"entity":"Orders.details","dialect":"Oracle","source":"Oracle","sentence":"UPDATE \"Order Details\" o1 SET OrderID = :orderId,ProductID = :productId,UnitPrice = :unitPrice,Quantity = :quantity,Discount = :discount WHERE (o1.OrderID = :orderId AND o1.ProductID = :productId) ","children":[]}]}]}
		let Oracle = orm.sentence(expression,{stage:'Oracle'})
		expect(OracleExpected).toStrictEqual(Oracle)
		const MongoDBExpected = {"entity":"Customers","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"\\\"_id\\\"\\\":{{id}},\\\"CompanyName\\\":{{name}},\\\"ContactName\\\":{{contact}},\\\"ContactTitle\\\":{{phone}},\\\"Address\\\":{{address}},\\\"City\\\":{{city}},\\\"Region\\\":{{region}},\\\"PostalCode\\\":{{postalCode}},\\\"Country\\\":{{country}} }}\",\"filter\":\"{ \\\"_id\\\":{{id}} }\"}","children":[{"entity":"Orders","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"CustomerID\\\":{{customerId}},\\\"EmployeeID\\\":{{employeeId}},\\\"OrderDate\\\":{{orderDate}},\\\"RequiredDate\\\":{{requiredDate}},\\\"ShippedDate\\\":{{shippedDate}},\\\"ShipVia\\\":{{shipViaId}},\\\"Freight\\\":{{freight}},\\\"ShipName\\\":{{name}},\\\"ShipAddress\\\":{{address}},\\\"ShipCity\\\":{{city}},\\\"ShipRegion\\\":{{region}},\\\"ShipPostalCode\\\":{{postalCode}},\\\"ShipCountry\\\":{{country}} }}\",\"filter\":\"{ \\\"_id\\\":{{id}} }\"}","children":[{"entity":"Orders.details","dialect":"MongoDB","source":"MongoDB","sentence":"{\"set\":\"{ \\\"$set\\\" :{ \\\"OrderID\\\":{{orderId}},\\\"ProductID\\\":{{productId}},\\\"UnitPrice\\\":{{unitPrice}},\\\"Quantity\\\":{{quantity}},\\\"Discount\\\":{{discount}} }}\",\"filter\":\"{ \\\"$and\\\" :[{ \\\"OrderID\\\":{{orderId}} },{ \\\"ProductID\\\":{{productId}} }] }\"}","children":[]}]}]}
		let MongoDB = orm.sentence(expression,{stage:'MongoDB'})
		expect(MongoDBExpected).toStrictEqual(MongoDB)
	})
})